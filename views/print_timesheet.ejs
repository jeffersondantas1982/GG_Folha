<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <title>Folha de Ponto - <%= monthName %>/<%= year %>
    </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @media print {
            .page-break {
                page-break-after: always;
            }

            @page {
                size: A4;
                margin: 8mm;
            }

            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }

        .timesheet-table th,
        .timesheet-table td {
            border: 1px solid black;
            padding: 2px 4px;
            text-align: center;
            font-size: 11px;
        }

        /* Weekend highlights removed per user request */
        .weekend-row {
            font-weight: bold;
        }
    </style>
</head>

<body class="bg-white text-black text-[11px] leading-tight">

    <% professionals.forEach((prof, index)=> { %>

        <div class="page-break mb-8 last:mb-0">

            <!-- Header Redesign based on image -->
            <div class="border border-black overflow-hidden mb-4">
                <div class="flex items-center p-2 border-b border-black">
                    <div class="w-24 flex-shrink-0 flex justify-center">
                        <img src="<%= institution.logotipo %>" alt="Logo" class="max-h-12 object-contain"
                            onerror="this.style.display='none'">
                    </div>
                    <div class="flex-1 text-center pr-24">
                        <h1 class="font-bold text-sm uppercase">FOLHA INDIVIDUAL DE FREQUÊNCIA</h1>
                        <p class="font-bold text-xs">Período: 01 a <%= days.length %>/<%= monthName %>/<%= year %>
                        </p>
                    </div>
                </div>

                <div class="text-center py-1 text-[9px] border-b border-black uppercase bg-gray-50/50">
                    <div>
                        <%= institution.nome %> - CNPJ: <%= institution.cnpj %>
                    </div>
                    <div>Endereço: <%= institution.endereco %>
                    </div>
                </div>

                <div class="grid grid-cols-2 text-[10px] uppercase">
                    <div class="border-r border-black">
                        <div class="flex border-b border-black">
                            <div class="w-12 border-r border-black p-1 font-bold">Nome:</div>
                            <div class="flex-1 p-1 font-bold">
                                <%= prof.nome %>
                            </div>
                        </div>
                        <div class="flex">
                            <div class="w-12 border-r border-black p-1 font-bold">Cargo:</div>
                            <div class="flex-1 p-1 font-bold">
                                <%= prof.cargo || '' %>
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="flex border-b border-black">
                            <div class="w-32 border-r border-black p-1 font-bold">Unidade de Trabalho:</div>
                            <div class="flex-1 p-1 font-bold">
                                <%= prof.unidade_exercicio || '' %>
                            </div>
                        </div>
                        <div class="flex">
                            <div class="w-32 border-r border-black p-1 font-bold">Matricula:</div>
                            <div class="flex-1 p-1 font-bold">
                                <%= prof.matricula || '' %>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Table -->
            <table class="w-full timesheet-table border-collapse mb-6">
                <thead>
                    <tr class="bg-gray-50 uppercase text-[10px]">
                        <th rowspan="2" class="w-8">DIA</th>
                        <th rowspan="2" class="w-12">Dia SEMANA</th>
                        <th rowspan="2" class="w-20">Entrada</th>
                        <th colspan="2">Intervalo</th>
                        <th rowspan="2" class="w-20">Saida</th>
                        <th colspan="2">Hora Extra</th>
                        <th rowspan="2" class="text-left px-4">Assinatura Empregado(a)</th>
                    </tr>
                    <tr class="bg-gray-50 uppercase text-[9px]">
                        <th class="w-16">Inicio</th>
                        <th class="w-16">Fim</th>
                        <th class="w-16">Inicio</th>
                        <th class="w-16">Fim</th>
                    </tr>
                </thead>
                <tbody>
                    <% days.forEach(day=> { %>
                        <tr class="<%= day.isWeekend ? 'font-bold' : '' %>" style="height: 22px;">
                            <td>
                                <%= day.day %>
                            </td>
                            <td class="text-[10px]">
                                <%= day.label %>
                            </td>

                            <td>:</td>
                            <td>:</td>
                            <td>:</td>
                            <td>:</td>
                            <td>:</td>
                            <td>:</td>

                            <td class="border-l border-black text-left px-4"></td>
                        </tr>
                        <% }) %>
                </tbody>
            </table>

            <!-- Footer Signatures - Side by Side -->
            <div class="mt-12 flex justify-around">
                <div class="w-64 text-center">
                    <div class="border-t border-black pt-1 uppercase text-[10px] font-bold">
                        Assinatura Empregado
                    </div>
                </div>
                <div class="w-64 text-center">
                    <div class="border-t border-black pt-1 uppercase text-[10px] font-bold">
                        Assinatura e Carimbo do Responsavel
                    </div>
                </div>
            </div>

            <div class="absolute bottom-0 left-0 right-0 text-[8px] text-gray-400 text-center italic uppercase">
                Gestão de Ponto
            </div>

        </div>

        <% }) %>

</body>

</html>